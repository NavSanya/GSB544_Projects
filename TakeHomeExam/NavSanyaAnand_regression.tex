% Options for packages loaded elsewhere
% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}
\usepackage{xcolor}
\usepackage{amsmath,amssymb}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother





\setlength{\emergencystretch}{3em} % prevent overfull lines

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}



 


\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Regression Notebook},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\title{Regression Notebook}
\author{}
\date{}
\begin{document}
\maketitle


\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}

\ImportTok{from}\NormalTok{ sklearn.model\_selection }\ImportTok{import}\NormalTok{ GridSearchCV, cross\_val\_score}
\ImportTok{from}\NormalTok{ sklearn.preprocessing }\ImportTok{import}\NormalTok{ OneHotEncoder, StandardScaler}
\ImportTok{from}\NormalTok{ sklearn.compose }\ImportTok{import}\NormalTok{ ColumnTransformer}
\ImportTok{from}\NormalTok{ sklearn.pipeline }\ImportTok{import}\NormalTok{ Pipeline}
\ImportTok{from}\NormalTok{ sklearn.linear\_model }\ImportTok{import}\NormalTok{ LinearRegression, Ridge, Lasso}
\ImportTok{from}\NormalTok{ sklearn.tree }\ImportTok{import}\NormalTok{ DecisionTreeRegressor}
\ImportTok{from}\NormalTok{ sklearn.neighbors }\ImportTok{import}\NormalTok{ KNeighborsRegressor}
\ImportTok{from}\NormalTok{ sklearn.impute }\ImportTok{import}\NormalTok{ SimpleImputer}
\ImportTok{from}\NormalTok{ sklearn.preprocessing }\ImportTok{import}\NormalTok{ PolynomialFeatures}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Paths to the training and test data (adjust if needed)}
\NormalTok{train\_path }\OperatorTok{=} \StringTok{"Data/gsb{-}544{-}fall{-}2025{-}regression/train\_new.csv"}
\NormalTok{test\_path  }\OperatorTok{=} \StringTok{"Data/gsb{-}544{-}fall{-}2025{-}regression/test\_new.csv"}

\NormalTok{train }\OperatorTok{=}\NormalTok{ pd.read\_csv(train\_path)}
\NormalTok{test  }\OperatorTok{=}\NormalTok{ pd.read\_csv(test\_path)}

\NormalTok{display(train.head())}
\NormalTok{display(test.head())}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}llllllllllllllllllllllllll@{}}
\toprule\noalign{}
& SalePrice & PID & Lot Frontage & Lot Area & Street & Neighborhood &
Bldg Type & House Style & Overall Qual & Overall Cond & Year Built &
Roof Style & Heating & Central Air & Electrical & Full Bath & Half Bath
& Bedroom AbvGr & TotRms AbvGrd & Gr Liv Area & Functional & Screen
Porch & Pool Area & Yr Sold & Sale Type \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0 & 159000 & 531363010 & 80.0 & 9605 & Pave & SawyerW & 1Fam & 1Story &
7 & 6 & 2007 & Gable & GasA & Y & SBrkr & 1 & 1 & 3 & 6 & 1218 & Typ & 0
& 0 & 2009 & WD \\
1 & 271900 & 906203120 & 90.0 & 14684 & Pave & SawyerW & 1Fam & 1Story &
7 & 7 & 1990 & Hip & GasA & Y & SBrkr & 2 & 0 & 3 & 7 & 2196 & Typ & 0 &
0 & 2009 & WD \\
2 & 137500 & 916176030 & NaN & 14375 & Pave & Timber & 1Fam & SLvl & 6 &
6 & 1958 & Gable & GasA & Y & FuseA & 1 & 0 & 3 & 7 & 1344 & Typ & 233 &
0 & 2009 & COD \\
3 & 248500 & 528180130 & 48.0 & 6472 & Pave & NridgHt & TwnhsE & 1Story
& 9 & 5 & 2008 & Hip & GasA & Y & SBrkr & 2 & 0 & 2 & 6 & 1456 & Typ & 0
& 0 & 2009 & WD \\
4 & 167000 & 528290030 & 61.0 & 9734 & Pave & Gilbert & 1Fam & SLvl & 7
& 5 & 2004 & Gable & GasA & Y & SBrkr & 2 & 1 & 3 & 7 & 1374 & Typ & 0 &
0 & 2009 & WD \\
\end{longtable}

\begin{longtable}[]{@{}lllllllllllllllllllllllll@{}}
\toprule\noalign{}
& PID & Lot Frontage & Lot Area & Street & Neighborhood & Bldg Type &
House Style & Overall Qual & Overall Cond & Year Built & Roof Style &
Heating & Central Air & Electrical & Full Bath & Half Bath & Bedroom
AbvGr & TotRms AbvGrd & Gr Liv Area & Functional & Screen Porch & Pool
Area & Yr Sold & Sale Type \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0 & 907135180 & 60 & 8070 & Pave & CollgCr & 1Fam & 1Story & 4 & 5 &
1994 & Gable & GasA & Y & SBrkr & 1 & 0 & 3 & 5 & 990 & Typ & 0 & 0 &
2007 & WD \\
1 & 528181040 & 40 & 6792 & Pave & NridgHt & TwnhsE & 1Story & 7 & 5 &
2005 & Gable & GasA & Y & SBrkr & 2 & 0 & 2 & 6 & 1368 & Typ & 0 & 0 &
2006 & New \\
2 & 528175010 & 44 & 6371 & Pave & NridgHt & TwnhsE & 1Story & 7 & 5 &
2009 & Gable & GasA & Y & SBrkr & 2 & 0 & 2 & 6 & 1358 & Typ & 0 & 0 &
2010 & New \\
3 & 531379030 & 70 & 8304 & Pave & SawyerW & 1Fam & 2Story & 6 & 5 &
1997 & Gable & GasA & Y & SBrkr & 2 & 1 & 3 & 7 & 1837 & Typ & 0 & 0 &
2006 & WD \\
4 & 923275090 & 37 & 6951 & Pave & Mitchel & 1Fam & 1Story & 5 & 5 &
1984 & Gable & GasA & Y & SBrkr & 1 & 0 & 3 & 5 & 923 & Typ & 0 & 0 &
2008 & WD \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{display(train.describe())}
\NormalTok{display(test.describe())}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}llllllllllllllll@{}}
\toprule\noalign{}
& SalePrice & PID & Lot Frontage & Lot Area & Overall Qual & Overall
Cond & Year Built & Full Bath & Half Bath & Bedroom AbvGr & TotRms
AbvGrd & Gr Liv Area & Screen Porch & Pool Area & Yr Sold \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
count & 2197.000000 & 2.197000e+03 & 1835.000000 & 2197.000000 &
2197.000000 & 2197.000000 & 2197.000000 & 2197.000000 & 2197.000000 &
2197.000000 & 2197.000000 & 2197.000000 & 2197.000000 & 2197.000000 &
2197.000000 \\
mean & 182376.851161 & 7.127872e+08 & 69.549319 & 10268.070096 &
6.116523 & 5.552572 & 1972.030951 & 1.592626 & 0.369595 & 2.858898 &
6.470642 & 1507.873464 & 15.954028 & 2.789713 & 2007.793810 \\
std & 81168.157405 & 1.887751e+08 & 23.188224 & 7975.740885 & 1.429613 &
1.107019 & 30.450069 & 0.553347 & 0.500405 & 0.834769 & 1.591381 &
511.844406 & 56.495484 & 39.991010 & 1.314345 \\
min & 13100.000000 & 5.263011e+08 & 21.000000 & 1300.000000 & 1.000000 &
1.000000 & 1872.000000 & 0.000000 & 0.000000 & 0.000000 & 2.000000 &
334.000000 & 0.000000 & 0.000000 & 2006.000000 \\
25\% & 130000.000000 & 5.284410e+08 & 58.500000 & 7500.000000 & 5.000000
& 5.000000 & 1954.000000 & 1.000000 & 0.000000 & 2.000000 & 5.000000 &
1142.000000 & 0.000000 & 0.000000 & 2007.000000 \\
50\% & 163500.000000 & 5.354532e+08 & 69.000000 & 9488.000000 & 6.000000
& 5.000000 & 1975.000000 & 2.000000 & 0.000000 & 3.000000 & 6.000000 &
1452.000000 & 0.000000 & 0.000000 & 2008.000000 \\
75\% & 215000.000000 & 9.071811e+08 & 80.000000 & 11660.000000 &
7.000000 & 6.000000 & 2002.000000 & 2.000000 & 1.000000 & 3.000000 &
7.000000 & 1762.000000 & 0.000000 & 0.000000 & 2009.000000 \\
max & 755000.000000 & 1.007100e+09 & 313.000000 & 215245.000000 &
10.000000 & 9.000000 & 2010.000000 & 4.000000 & 2.000000 & 8.000000 &
15.000000 & 5642.000000 & 576.000000 & 800.000000 & 2010.000000 \\
\end{longtable}

\begin{longtable}[]{@{}lllllllllllllll@{}}
\toprule\noalign{}
& PID & Lot Frontage & Lot Area & Overall Qual & Overall Cond & Year
Built & Full Bath & Half Bath & Bedroom AbvGr & TotRms AbvGrd & Gr Liv
Area & Screen Porch & Pool Area & Yr Sold \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
count & 6.050000e+02 & 605.000000 & 605.000000 & 605.000000 & 605.000000
& 605.000000 & 605.000000 & 605.000000 & 605.00000 & 605.000000 &
605.000000 & 605.000000 & 605.000000 & 605.000000 \\
mean & 7.149952e+08 & 68.239669 & 9232.049587 & 6.039669 & 5.578512 &
1968.464463 & 1.484298 & 0.398347 & 2.82314 & 6.332231 & 1463.930579 &
17.181818 & 0.733884 & 2007.757025 \\
std & 1.885002e+08 & 23.886953 & 4280.948456 & 1.397164 & 1.147644 &
30.724704 & 0.535342 & 0.503298 & 0.80774 & 1.523666 & 484.398263 &
57.083360 & 18.051167 & 1.339222 \\
min & 5.263521e+08 & 21.000000 & 1484.000000 & 2.000000 & 1.000000 &
1880.000000 & 0.000000 & 0.000000 & 0.00000 & 3.000000 & 540.000000 &
0.000000 & 0.000000 & 2006.000000 \\
25\% & 5.314500e+08 & 58.000000 & 7200.000000 & 5.000000 & 5.000000 &
1949.000000 & 1.000000 & 0.000000 & 2.00000 & 5.000000 & 1092.000000 &
0.000000 & 0.000000 & 2007.000000 \\
50\% & 5.354530e+08 & 66.000000 & 9120.000000 & 6.000000 & 5.000000 &
1970.000000 & 1.000000 & 0.000000 & 3.00000 & 6.000000 & 1377.000000 &
0.000000 & 0.000000 & 2008.000000 \\
75\% & 9.064771e+08 & 80.000000 & 10880.000000 & 7.000000 & 6.000000 &
1998.000000 & 2.000000 & 1.000000 & 3.00000 & 7.000000 & 1709.000000 &
0.000000 & 0.000000 & 2009.000000 \\
max & 9.241510e+08 & 313.000000 & 50271.000000 & 10.000000 & 9.000000 &
2010.000000 & 3.000000 & 2.000000 & 6.00000 & 12.000000 & 3820.000000 &
410.000000 & 444.000000 & 2010.000000 \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{display(train.nunique())}
\NormalTok{display(test.nunique())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
SalePrice         874
PID              2197
Lot Frontage      122
Lot Area         1549
Street              2
Neighborhood       28
Bldg Type           5
House Style         8
Overall Qual       10
Overall Cond        9
Year Built        116
Roof Style          6
Heating             6
Central Air         2
Electrical          5
Full Bath           5
Half Bath           3
Bedroom AbvGr       8
TotRms AbvGrd      13
Gr Liv Area      1118
Functional          8
Screen Porch       99
Pool Area          13
Yr Sold             5
Sale Type          10
dtype: int64
\end{verbatim}

\begin{verbatim}
PID              605
Lot Frontage      99
Lot Area         489
Street             2
Neighborhood      26
Bldg Type          5
House Style        8
Overall Qual       9
Overall Cond       9
Year Built        95
Roof Style         6
Heating            3
Central Air        2
Electrical         4
Full Bath          4
Half Bath          3
Bedroom AbvGr      7
TotRms AbvGrd     10
Gr Liv Area      454
Functional         7
Screen Porch      47
Pool Area          2
Yr Sold            5
Sale Type          9
dtype: int64
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{display(train.isnull().}\BuiltInTok{sum}\NormalTok{())}
\NormalTok{display(test.isnull().}\BuiltInTok{sum}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
SalePrice          0
PID                0
Lot Frontage     362
Lot Area           0
Street             0
Neighborhood       0
Bldg Type          0
House Style        0
Overall Qual       0
Overall Cond       0
Year Built         0
Roof Style         0
Heating            0
Central Air        0
Electrical         1
Full Bath          0
Half Bath          0
Bedroom AbvGr      0
TotRms AbvGrd      0
Gr Liv Area        0
Functional         0
Screen Porch       0
Pool Area          0
Yr Sold            0
Sale Type          0
dtype: int64
\end{verbatim}

\begin{verbatim}
PID              0
Lot Frontage     0
Lot Area         0
Street           0
Neighborhood     0
Bldg Type        0
House Style      0
Overall Qual     0
Overall Cond     0
Year Built       0
Roof Style       0
Heating          0
Central Air      0
Electrical       0
Full Bath        0
Half Bath        0
Bedroom AbvGr    0
TotRms AbvGrd    0
Gr Liv Area      0
Functional       0
Screen Porch     0
Pool Area        0
Yr Sold          0
Sale Type        0
dtype: int64
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{train[}\StringTok{\textquotesingle{}Lot Frontage\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ train[}\StringTok{\textquotesingle{}Lot Frontage\textquotesingle{}}\NormalTok{].fillna(train[}\StringTok{\textquotesingle{}Lot Frontage\textquotesingle{}}\NormalTok{].median())}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{train[}\StringTok{\textquotesingle{}Electrical\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ train[}\StringTok{\textquotesingle{}Electrical\textquotesingle{}}\NormalTok{].fillna(train[}\StringTok{\textquotesingle{}Electrical\textquotesingle{}}\NormalTok{].mode()[}\DecValTok{0}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OperatorTok{=}\NormalTok{ np.log1p(train[}\StringTok{"SalePrice"}\NormalTok{])}
\NormalTok{X }\OperatorTok{=}\NormalTok{ train.drop(columns}\OperatorTok{=}\NormalTok{[}\StringTok{"SalePrice"}\NormalTok{, }\StringTok{"PID"}\NormalTok{])}
\NormalTok{X\_test }\OperatorTok{=}\NormalTok{ test.drop(columns}\OperatorTok{=}\NormalTok{[}\StringTok{"PID"}\NormalTok{])}

\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{print}\NormalTok{(}\StringTok{"Train shape:"}\NormalTok{, X.shape)}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Test shape:"}\NormalTok{, X\_test.shape)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Train shape: (2197, 23)
Test shape: (605, 23)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Feature engineering}
\KeywordTok{def}\NormalTok{ engineer\_features(df):}
\NormalTok{    df }\OperatorTok{=}\NormalTok{ df.copy()}
    
    \CommentTok{\# House age}
\NormalTok{    df[}\StringTok{"HouseAge"}\NormalTok{] }\OperatorTok{=}\NormalTok{ df[}\StringTok{"Yr Sold"}\NormalTok{] }\OperatorTok{{-}}\NormalTok{ df[}\StringTok{"Year Built"}\NormalTok{]}
    
    \CommentTok{\# Total bathrooms (full + half*0.5)}
\NormalTok{    df[}\StringTok{"TotalBath"}\NormalTok{] }\OperatorTok{=}\NormalTok{ df[}\StringTok{"Full Bath"}\NormalTok{] }\OperatorTok{+} \FloatTok{0.5} \OperatorTok{*}\NormalTok{ df[}\StringTok{"Half Bath"}\NormalTok{]}
    
    \CommentTok{\# Total rooms including baths}
\NormalTok{    df[}\StringTok{"TotalRooms"}\NormalTok{] }\OperatorTok{=}\NormalTok{ df[}\StringTok{"TotRms AbvGrd"}\NormalTok{] }\OperatorTok{+}\NormalTok{ df[}\StringTok{"Full Bath"}\NormalTok{] }\OperatorTok{+}\NormalTok{ df[}\StringTok{"Half Bath"}\NormalTok{]}
    
    \CommentTok{\# Quality x Area interaction}
\NormalTok{    df[}\StringTok{"Qual\_x\_Area"}\NormalTok{] }\OperatorTok{=}\NormalTok{ df[}\StringTok{"Overall Qual"}\NormalTok{] }\OperatorTok{*}\NormalTok{ df[}\StringTok{"Gr Liv Area"}\NormalTok{]}
    
    \CommentTok{\# Area per room (avoid division by zero)}
\NormalTok{    df[}\StringTok{"AreaPerRoom"}\NormalTok{] }\OperatorTok{=}\NormalTok{ df[}\StringTok{"Gr Liv Area"}\NormalTok{] }\OperatorTok{/}\NormalTok{ (df[}\StringTok{"TotRms AbvGrd"}\NormalTok{] }\OperatorTok{+} \DecValTok{1}\NormalTok{)}
    
    \CommentTok{\# Log{-}transform skewed numeric features (log1p handles zeros)}
    \ControlFlowTok{for}\NormalTok{ col }\KeywordTok{in}\NormalTok{ [}\StringTok{"Lot Area"}\NormalTok{, }\StringTok{"Gr Liv Area"}\NormalTok{, }\StringTok{"Pool Area"}\NormalTok{, }\StringTok{"Screen Porch"}\NormalTok{]:}
        \ControlFlowTok{if}\NormalTok{ col }\KeywordTok{in}\NormalTok{ df.columns:}
\NormalTok{            df[col] }\OperatorTok{=}\NormalTok{ np.log1p(df[col])}
    
    \ControlFlowTok{return}\NormalTok{ df}

\NormalTok{X }\OperatorTok{=}\NormalTok{ engineer\_features(X)}
\NormalTok{X\_test }\OperatorTok{=}\NormalTok{ engineer\_features(X\_test)}

\BuiltInTok{print}\NormalTok{(}\StringTok{"Engineered train shape:"}\NormalTok{, X.shape)}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Engineered test shape:"}\NormalTok{, X\_test.shape)}

\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Engineered train shape: (2197, 28)
Engineered test shape: (605, 28)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Identify numeric and categorical columns}
\NormalTok{numeric\_features }\OperatorTok{=}\NormalTok{ X.select\_dtypes(include}\OperatorTok{=}\NormalTok{[np.number]).columns.tolist()}
\NormalTok{categorical\_features }\OperatorTok{=}\NormalTok{ X.select\_dtypes(exclude}\OperatorTok{=}\NormalTok{[np.number]).columns.tolist()}

\BuiltInTok{print}\NormalTok{(}\StringTok{"Numeric columns:"}\NormalTok{, numeric\_features)}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Categorical columns:"}\NormalTok{, categorical\_features)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Numeric columns: ['Lot Frontage', 'Lot Area', 'Overall Qual', 'Overall Cond', 'Year Built', 'Full Bath', 'Half Bath', 'Bedroom AbvGr', 'TotRms AbvGrd', 'Gr Liv Area', 'Screen Porch', 'Pool Area', 'Yr Sold', 'HouseAge', 'TotalBath', 'TotalRooms', 'Qual_x_Area', 'AreaPerRoom']
Categorical columns: ['Street', 'Neighborhood', 'Bldg Type', 'House Style', 'Roof Style', 'Heating', 'Central Air', 'Electrical', 'Functional', 'Sale Type']
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{numeric\_transformer\_plain }\OperatorTok{=}\NormalTok{ Pipeline(}
\NormalTok{    steps}\OperatorTok{=}\NormalTok{[}
\NormalTok{        (}\StringTok{"imputer"}\NormalTok{, SimpleImputer(strategy}\OperatorTok{=}\StringTok{"median"}\NormalTok{)),}
\NormalTok{        (}\StringTok{"scaler"}\NormalTok{, StandardScaler())}
\NormalTok{    ]}
\NormalTok{)}

\NormalTok{numeric\_transformer\_poly\_full }\OperatorTok{=}\NormalTok{ Pipeline(}
\NormalTok{    steps}\OperatorTok{=}\NormalTok{[}
\NormalTok{        (}\StringTok{"imputer"}\NormalTok{, SimpleImputer(strategy}\OperatorTok{=}\StringTok{"median"}\NormalTok{)),}
\NormalTok{        (}\StringTok{"poly"}\NormalTok{, PolynomialFeatures(degree}\OperatorTok{=}\DecValTok{3}\NormalTok{, include\_bias}\OperatorTok{=}\VariableTok{False}\NormalTok{)),  }\CommentTok{\# degree 2 â†’ 3}
\NormalTok{        (}\StringTok{"scaler"}\NormalTok{, StandardScaler())}
\NormalTok{    ]}
\NormalTok{)}

\NormalTok{numeric\_transformer\_poly\_interact }\OperatorTok{=}\NormalTok{ Pipeline(}
\NormalTok{    steps}\OperatorTok{=}\NormalTok{[}
\NormalTok{        (}\StringTok{"imputer"}\NormalTok{, SimpleImputer(strategy}\OperatorTok{=}\StringTok{"median"}\NormalTok{)),}
\NormalTok{        (}\StringTok{"poly"}\NormalTok{, PolynomialFeatures(degree}\OperatorTok{=}\DecValTok{3}\NormalTok{, include\_bias}\OperatorTok{=}\VariableTok{False}\NormalTok{, interaction\_only}\OperatorTok{=}\VariableTok{True}\NormalTok{)),}
\NormalTok{        (}\StringTok{"scaler"}\NormalTok{, StandardScaler())}
\NormalTok{    ]}
\NormalTok{)}

\NormalTok{categorical\_transformer }\OperatorTok{=}\NormalTok{ Pipeline(}
\NormalTok{    steps}\OperatorTok{=}\NormalTok{[}
\NormalTok{        (}\StringTok{"imputer"}\NormalTok{, SimpleImputer(strategy}\OperatorTok{=}\StringTok{"most\_frequent"}\NormalTok{)),}
\NormalTok{        (}\StringTok{"onehot"}\NormalTok{, OneHotEncoder(handle\_unknown}\OperatorTok{=}\StringTok{"ignore"}\NormalTok{))}
\NormalTok{    ]}
\NormalTok{)}

\NormalTok{preprocessor\_plain }\OperatorTok{=}\NormalTok{ ColumnTransformer(}
\NormalTok{    transformers}\OperatorTok{=}\NormalTok{[}
\NormalTok{        (}\StringTok{"num"}\NormalTok{, numeric\_transformer\_plain, numeric\_features),}
\NormalTok{        (}\StringTok{"cat"}\NormalTok{, categorical\_transformer, categorical\_features)}
\NormalTok{    ]}
\NormalTok{)}

\NormalTok{preprocessor\_poly\_full }\OperatorTok{=}\NormalTok{ ColumnTransformer(}
\NormalTok{    transformers}\OperatorTok{=}\NormalTok{[}
\NormalTok{        (}\StringTok{"num"}\NormalTok{, numeric\_transformer\_poly\_full, numeric\_features),}
\NormalTok{        (}\StringTok{"cat"}\NormalTok{, categorical\_transformer, categorical\_features)}
\NormalTok{    ]}
\NormalTok{)}

\NormalTok{preprocessor\_poly\_interact }\OperatorTok{=}\NormalTok{ ColumnTransformer(}
\NormalTok{    transformers}\OperatorTok{=}\NormalTok{[}
\NormalTok{        (}\StringTok{"num"}\NormalTok{, numeric\_transformer\_poly\_interact, numeric\_features),}
\NormalTok{        (}\StringTok{"cat"}\NormalTok{, categorical\_transformer, categorical\_features)}
\NormalTok{    ]}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{models }\OperatorTok{=}\NormalTok{ \{}
    \StringTok{"lr"}\NormalTok{: (preprocessor\_plain, LinearRegression()),}
    \StringTok{"dt"}\NormalTok{: (preprocessor\_plain, DecisionTreeRegressor(random\_state}\OperatorTok{=}\DecValTok{0}\NormalTok{)),}
    \StringTok{"knn"}\NormalTok{: (preprocessor\_plain, KNeighborsRegressor()),}

    \StringTok{"poly\_full"}\NormalTok{: (preprocessor\_poly\_full, LinearRegression()),}
    \StringTok{"poly\_interact"}\NormalTok{: (preprocessor\_poly\_interact, LinearRegression()),}

    \StringTok{"ridge"}\NormalTok{: (preprocessor\_plain, Ridge()),}
    \StringTok{"lasso"}\NormalTok{: (preprocessor\_plain, Lasso(max\_iter}\OperatorTok{=}\DecValTok{10000}\NormalTok{)),}

    \CommentTok{\# Ridge with full quadratic polynomial features}
    \StringTok{"ridge\_poly"}\NormalTok{: (preprocessor\_poly\_full, Ridge()),}

    \CommentTok{\# Ridge with interaction{-}only polynomial features}
    \StringTok{"ridge\_poly\_interact"}\NormalTok{: (preprocessor\_poly\_interact, Ridge())}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{params }\OperatorTok{=}\NormalTok{ \{}
    \StringTok{"dt"}\NormalTok{: \{}
        \StringTok{"model\_\_max\_depth"}\NormalTok{: [}\DecValTok{5}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{20}\NormalTok{, }\VariableTok{None}\NormalTok{],}
        \StringTok{"model\_\_min\_samples\_leaf"}\NormalTok{: [}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{20}\NormalTok{],}
        \StringTok{"model\_\_min\_samples\_split"}\NormalTok{: [}\DecValTok{2}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{20}\NormalTok{]}
\NormalTok{    \},}
    \StringTok{"knn"}\NormalTok{: \{}
        \StringTok{"model\_\_n\_neighbors"}\NormalTok{: }\BuiltInTok{list}\NormalTok{(}\BuiltInTok{range}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{2}\NormalTok{)),}
        \StringTok{"model\_\_weights"}\NormalTok{: [}\StringTok{"uniform"}\NormalTok{, }\StringTok{"distance"}\NormalTok{],}
        \StringTok{"model\_\_metric"}\NormalTok{: [}\StringTok{"euclidean"}\NormalTok{, }\StringTok{"manhattan"}\NormalTok{]}
\NormalTok{    \},}
    \StringTok{"ridge"}\NormalTok{: \{}
    \StringTok{"model\_\_alpha"}\NormalTok{: np.logspace(}\OperatorTok{{-}}\DecValTok{4}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{20}\NormalTok{)  }\CommentTok{\# 1e{-}4 to 1e3}
\NormalTok{        \},}
        \StringTok{"lasso"}\NormalTok{: \{}
        \StringTok{"model\_\_alpha"}\NormalTok{: np.logspace(}\OperatorTok{{-}}\DecValTok{5}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{25}\NormalTok{),  }\CommentTok{\# much wider search}
        \StringTok{"model\_\_max\_iter"}\NormalTok{: [}\DecValTok{50000}\NormalTok{],}
        \StringTok{"model\_\_tol"}\NormalTok{: [}\FloatTok{1e{-}4}\NormalTok{, }\FloatTok{1e{-}5}\NormalTok{]}
\NormalTok{        \},}
        \StringTok{"ridge\_poly"}\NormalTok{: \{}
        \StringTok{"model\_\_alpha"}\NormalTok{: np.logspace(}\OperatorTok{{-}}\DecValTok{4}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{25}\NormalTok{)}
\NormalTok{        \},}
        \StringTok{"ridge\_poly\_interact"}\NormalTok{: \{}
        \StringTok{"model\_\_alpha"}\NormalTok{: np.logspace(}\OperatorTok{{-}}\DecValTok{4}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{20}\NormalTok{)}
\NormalTok{        \}}

\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{best\_models }\OperatorTok{=}\NormalTok{ \{\}}
\NormalTok{cv\_scores\_mse }\OperatorTok{=}\NormalTok{ \{\}}
\NormalTok{cv\_scores\_rmse }\OperatorTok{=}\NormalTok{ \{\}}

\ControlFlowTok{for}\NormalTok{ name, (preproc, model) }\KeywordTok{in}\NormalTok{ models.items():}

\NormalTok{    pipe }\OperatorTok{=}\NormalTok{ Pipeline([}
\NormalTok{        (}\StringTok{"pre"}\NormalTok{, preproc),}
\NormalTok{        (}\StringTok{"model"}\NormalTok{, model)}
\NormalTok{    ])}

    \BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"}\CharTok{\textbackslash{}n}\SpecialStringTok{=== Tuning / evaluating }\SpecialCharTok{\{}\NormalTok{name}\SpecialCharTok{\}}\SpecialStringTok{ ==="}\NormalTok{)}

    \ControlFlowTok{if}\NormalTok{ name }\KeywordTok{in}\NormalTok{ params:   }\CommentTok{\# only DT and KNN use grids}
\NormalTok{        gs }\OperatorTok{=}\NormalTok{ GridSearchCV(}
\NormalTok{            estimator}\OperatorTok{=}\NormalTok{pipe,}
\NormalTok{            param\_grid}\OperatorTok{=}\NormalTok{params[name],}
\NormalTok{            cv}\OperatorTok{=}\DecValTok{5}\NormalTok{,}
\NormalTok{            scoring}\OperatorTok{=}\StringTok{"neg\_mean\_squared\_error"}\NormalTok{,}
\NormalTok{            n\_jobs}\OperatorTok{={-}}\DecValTok{1}
\NormalTok{        )}
\NormalTok{        gs.fit(X, y)}
\NormalTok{        best\_models[name] }\OperatorTok{=}\NormalTok{ gs.best\_estimator\_}
\NormalTok{        best\_mse }\OperatorTok{=} \OperatorTok{{-}}\NormalTok{gs.best\_score\_}
    \ControlFlowTok{else}\NormalTok{:}
\NormalTok{        scores }\OperatorTok{=}\NormalTok{ cross\_val\_score(pipe, X, y, cv}\OperatorTok{=}\DecValTok{5}\NormalTok{,}
\NormalTok{                                 scoring}\OperatorTok{=}\StringTok{"neg\_mean\_squared\_error"}\NormalTok{,}
\NormalTok{                                 n\_jobs}\OperatorTok{={-}}\DecValTok{1}\NormalTok{)}
\NormalTok{        pipe.fit(X, y)}
\NormalTok{        best\_models[name] }\OperatorTok{=}\NormalTok{ pipe}
\NormalTok{        best\_mse }\OperatorTok{=} \OperatorTok{{-}}\NormalTok{scores.mean()}

\NormalTok{    cv\_scores\_mse[name] }\OperatorTok{=}\NormalTok{ best\_mse}
\NormalTok{    cv\_scores\_rmse[name] }\OperatorTok{=}\NormalTok{ np.sqrt(best\_mse)}

    \BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"}\SpecialCharTok{\{}\NormalTok{name}\SpecialCharTok{\}}\SpecialStringTok{ CV MSE: }\SpecialCharTok{\{}\NormalTok{best\_mse}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
    \BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"}\SpecialCharTok{\{}\NormalTok{name}\SpecialCharTok{\}}\SpecialStringTok{ CV RMSE: }\SpecialCharTok{\{}\NormalTok{cv\_scores\_rmse[name]}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

=== Tuning / evaluating lr ===
lr CV MSE: 0.019137
lr CV RMSE: 0.138338

=== Tuning / evaluating dt ===
dt CV MSE: 0.030325
dt CV RMSE: 0.174139

=== Tuning / evaluating knn ===
knn CV MSE: 0.024246
knn CV RMSE: 0.155712

=== Tuning / evaluating poly_full ===
poly_full CV MSE: 2.086198
poly_full CV RMSE: 1.444368

=== Tuning / evaluating poly_interact ===
poly_interact CV MSE: 0.229654
poly_interact CV RMSE: 0.479222

=== Tuning / evaluating ridge ===
ridge CV MSE: 0.018929
ridge CV RMSE: 0.137583

=== Tuning / evaluating lasso ===
lasso CV MSE: 0.018812
lasso CV RMSE: 0.137157

=== Tuning / evaluating ridge_poly ===
ridge_poly CV MSE: 0.017306
ridge_poly CV RMSE: 0.131551

=== Tuning / evaluating ridge_poly_interact ===
ridge_poly_interact CV MSE: 0.017659
ridge_poly_interact CV RMSE: 0.132889
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{best\_name }\OperatorTok{=} \BuiltInTok{min}\NormalTok{(cv\_scores\_mse, key}\OperatorTok{=}\NormalTok{cv\_scores\_mse.get)  }\CommentTok{\# smallest MSE}
\NormalTok{final\_model }\OperatorTok{=}\NormalTok{ best\_models[best\_name]}

\BuiltInTok{print}\NormalTok{(}\StringTok{"}\CharTok{\textbackslash{}n}\StringTok{=== Model comparison (CV RMSE on log target) ==="}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{ name }\KeywordTok{in}\NormalTok{ cv\_scores\_rmse:}
    \BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"}\SpecialCharTok{\{}\NormalTok{name}\SpecialCharTok{\}}\SpecialStringTok{: RMSE\_log = }\SpecialCharTok{\{}\NormalTok{cv\_scores\_rmse[name]}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}

\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"}\CharTok{\textbackslash{}n}\SpecialStringTok{Best model based on CV MSE: }\SpecialCharTok{\{}\NormalTok{best\_name}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

=== Model comparison (CV RMSE on log target) ===
lr: RMSE_log = 0.13833794057267043
dt: RMSE_log = 0.17413931881303796
knn: RMSE_log = 0.15571202073849658
poly_full: RMSE_log = 1.4443677178230596
poly_interact: RMSE_log = 0.4792221096142678
ridge: RMSE_log = 0.13758309106720573
lasso: RMSE_log = 0.13715737756025506
ridge_poly: RMSE_log = 0.13155093053484992
ridge_poly_interact: RMSE_log = 0.13288899074069163

Best model based on CV MSE: ridge_poly
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{final\_model.fit(X, y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Pipeline(steps=[('pre',
                 ColumnTransformer(transformers=[('num',
                                                  Pipeline(steps=[('imputer',
                                                                   SimpleImputer(strategy='median')),
                                                                  ('poly',
                                                                   PolynomialFeatures(degree=3,
                                                                                      include_bias=False)),
                                                                  ('scaler',
                                                                   StandardScaler())]),
                                                  ['Lot Frontage', 'Lot Area',
                                                   'Overall Qual',
                                                   'Overall Cond', 'Year Built',
                                                   'Full Bath', 'Half Bath',
                                                   'Bedroom AbvGr',
                                                   'TotRms AbvGrd',
                                                   'Gr Liv Area',
                                                   'Screen Porc...
                                                   'TotalBath', 'TotalRooms',
                                                   'Qual_x_Area',
                                                   'AreaPerRoom']),
                                                 ('cat',
                                                  Pipeline(steps=[('imputer',
                                                                   SimpleImputer(strategy='most_frequent')),
                                                                  ('onehot',
                                                                   OneHotEncoder(handle_unknown='ignore'))]),
                                                  ['Street', 'Neighborhood',
                                                   'Bldg Type', 'House Style',
                                                   'Roof Style', 'Heating',
                                                   'Central Air', 'Electrical',
                                                   'Functional',
                                                   'Sale Type'])])),
                ('model', Ridge(alpha=np.float64(17.78279410038923)))])
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y\_test\_log\_pred }\OperatorTok{=}\NormalTok{ final\_model.predict(X\_test)}
\NormalTok{y\_test\_pred }\OperatorTok{=}\NormalTok{ np.expm1(y\_test\_log\_pred)   }\CommentTok{\# invert log1p}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Build submission}
\NormalTok{submission }\OperatorTok{=}\NormalTok{ pd.DataFrame(\{}
    \StringTok{"PID"}\NormalTok{: test[}\StringTok{"PID"}\NormalTok{],}
    \StringTok{"SalePrice"}\NormalTok{: y\_test\_pred}
\NormalTok{\})}

\NormalTok{submission\_path }\OperatorTok{=} \StringTok{"submission.csv"}
\NormalTok{submission.to\_csv(submission\_path, index}\OperatorTok{=}\VariableTok{False}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"Saved submission to }\SpecialCharTok{\{}\NormalTok{submission\_path}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Saved submission to submission.csv
\end{verbatim}




\end{document}
